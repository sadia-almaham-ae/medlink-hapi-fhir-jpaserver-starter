# File must be named render.yaml (not docker-compose.yml)
services:
  - type: web
    name: hapi-fhir-server
    env: docker
    dockerfilePath: Dockerfile
    plan: standard
    envVars:
      - key: SPRING_DATASOURCE_URL
        value: jdbc:postgresql://${postgres.HOST}:${postgres.PORT}/${postgres.DATABASE}?sslmode=require
      - key: SPRING_DATASOURCE_USERNAME
        value: ${postgres.USERNAME}
      - key: SPRING_DATASOURCE_PASSWORD
        value: ${postgres.PASSWORD}
      - key: SPRING_DATASOURCE_DRIVERCLASSNAME
        value: org.postgresql.Driver
    healthCheckPath: /fhir/metadata

  - type: postgres
    name: postgres
    plan: standard
    databaseName: hapi_4954
    user: admin
    # Password auto-generated by Render